---
import Hero from "../fragments/Hero.astro";
import Projects from "../fragments/Projects.astro";
import Layout from "../layouts/Layout.astro";
---

<Layout>
  <Hero id="hero_fragment" />
  <Projects id="projects_fragment" />
  <Hero id="hero2_fragment" />
</Layout>

<script>
  const projects = document.getElementById(
    "projects_fragment"
  ) as HTMLDivElement;

  let projectsOffset = projects.scrollHeight;

  function pourSecondColour() {
    if (window.scrollY < window.innerHeight) {
      const scrollPercentage = (window.scrollY * 100) / window.innerHeight;
      document.documentElement.style.setProperty(
        "--second-bg-color-pour",
        `${scrollPercentage}%`
      );
    } else {
      const pastH = window.scrollY - projectsOffset;

      if (pastH < window.innerHeight && pastH > 0) {
        const scrollPercentage = 100 - (pastH * 100) / window.innerHeight;
        document.documentElement.style.setProperty(
          "--second-bg-color-pour",
          `${scrollPercentage}%`
        );
      }
    }
  }

  window.addEventListener("resize", () => {
    projectsOffset = projects.scrollHeight;
    pourSecondColour();
  });

  window.addEventListener("scroll", () => {
    pourSecondColour();
  });
</script>
